(this["webpackJsonpcpr-practice"]=this["webpackJsonpcpr-practice"]||[]).push([[6],{37:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(33),r=n.n(a),s=n(34);function i(e,t){return c.apply(this,arguments)}function c(){return(c=Object(s.a)(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}if(!Reflect.has(t,"onanimationend")){e.next=5;break}return e.abrupt("return",new Promise((function(e){t.addEventListener("animationend",(function n(){t.removeEventListener("animationend",n),e(!0)}))})));case 5:return e.abrupt("return",new Promise((function(e){setTimeout(e,n)})));case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},38:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(0),r=n.n(a),s=n(31),i=n(50),c=n.n(i),o=n(35),u=[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10.2,10.75,11.5,12.25,13,12.25,11.5,10.75,10,10,10,10,10,9,8,12,17,22,11,6,8,10,10,10,10,10,10,10,10.33,10.66,11,11.42,11.85,12.28,12.71,13.14,13.57,14,13.5,13,12.5,12,11.5,11,10.5,10,10.5,11,11.5,12,11.6,11.2,10.8,10.4,10,10,10,10,10,10];function l(e){for(var t=e.index,n=void 0===t?0:t,a=e.round,r=void 0===a?1:a,s=e.value,i=n,c=r,l=[];c-- >0;){var m,h=0,f=Object(o.a)(u);try{for(f.s();!(m=f.n()).done;){var d=m.value,p=0;h&&(p=Math.random()*(h-d));var b=d+p;l.push({time:i++,value:s||b}),h=d}}catch(v){f.e(v)}finally{f.f()}}return l}var m={NORMAL:1,RIP:2},h=function e(t){var n=this;Object(s.a)(this,e),this.initChart=function(){var e=n.createChart,t=n.configChart;e(),t()},this.startBeat=function(){n.hasInited||n.initChart(),n.beatIndex||n.beat()},this.stopBeat=function(){},this.beat=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=n.beats,r=n.chart,s=n.prepareData;n.anmStartTime?e=t-(n.anmStartTime||0):(n.anmStartTime=t,e=0);for(var i=Math.floor(e/750*75);n.beatIndex<=i;){var c=n.beatIndex%75;0===c&&s();var o=n.nextBeatPhase[c];a.shift(),a.push(o),n.beatIndex++}r.changeData(a),requestAnimationFrame(n.beat)},this.prepareData=function(){switch(n.mode){case m.RIP:n.nextBeatPhase=l({index:n.beatIndex+n.baseIndex,value:10});break;case m.NORMAL:default:n.nextBeatPhase=l({index:n.beatIndex+n.baseIndex,round:1})}},this.setMode=function(e){console.log("ddd",e),n.mode=e},this.createChart=function(){var e=new c.a.Chart({el:n.container,pixelRatio:window.devicePixelRatio,animate:!1,padding:0});n.chart=e},this.configChart=function(){var e=n.chart,t=n.beats;e.source(t,{time:{type:"timeCat",mask:"HH:mm:ss",range:[0,1]},value:{tickCount:2,min:4,max:24}}),e.tooltip(!1),e.axis(!1),e.line().color("#d21818").position("time*value").shape("smooth"),e.render()},this.container=t,this.beats=l({index:0,round:3,value:10}),this.beatIndex=0,this.baseIndex=225,this.nextBeatPhase=[],this.mode=m.NORMAL,this.hasInited=!1};t.b=Object(a.forwardRef)((function(e,t){var n=Object(a.useRef)(),s=Object(a.useRef)();return Object(a.useImperativeHandle)(t,(function(){return{setMode:function(e){return s.current.setMode(e)},beat:function(){return s.current.startBeat()}}})),Object(a.useEffect)((function(){var e=new h(n.current);return s.current=e,function(){e.stopBeat()}}),[]),r.a.createElement("canvas",{className:"heartbeat ".concat(e.visibility?"":"hidden"),ref:n})}))},42:function(e,t,n){"use strict";var a=n(12),r=n(0),s=n.n(r);n(43);t.a=Object(r.forwardRef)((function(e,t){var n=e.speed,i=void 0===n?120:n,c=e.onTap,o=e.onMiss,u=e.requirement,l=void 0===u?0:u,m=Object(r.useState)(!1),h=Object(a.a)(m,2),f=h[0],d=h[1],p=Object(r.useState)(!1),b=Object(a.a)(p,2),v=b[0],g=b[1],w=Object(r.useRef)(),y=function(){d(!f)},E=function(){return g(!0)},O=function(){return g(!1)};return Object(r.useImperativeHandle)(t,(function(){return{togglePlay:y,show:E,hide:O}})),s.a.createElement("div",{className:"taptap",style:{display:v?"block":"none"}},s.a.createElement("img",{ref:w,style:{WebkitAnimationPlayState:f?"running":"paused",animationPlayState:f?"running":"paused",animationDuration:"".concat(60/i,"s")},src:"/images/tap/scroll.png",alt:"bg"}),s.a.createElement("div",{className:"cover",style:{WebkitAnimationPlayState:f?"running":"paused",animationPlayState:f?"running":"paused",animationDuration:"".concat(240/i,"s")}}),s.a.createElement("div",{className:"block",style:{WebkitAnimationPlayState:f?"running":"paused",animationPlayState:f?"running":"paused",animationDuration:"".concat(240/i,"s")}}),s.a.createElement("div",{className:"tap",onClick:function(){var e=document.defaultView.getComputedStyle(w.current,null).transform;if(e&&c&&/^matrix\(.+, .+, .+, .+, (.+), .+\)$/.test(e)){var t=Math.abs(Number(RegExp.$1))/(window.screen.width/4),n=1-2*Math.abs(t-.5);n>=l?c(n):o&&o(n)}}},"\u6309\u538b"))}))},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";var a=n(12),r=n(0),s=n.n(r);t.a=Object(r.forwardRef)((function(e,t){var n=Object(r.useRef)({}),i=Object(r.useState)({h:0,m:0,s:0}),c=Object(a.a)(i,2),o=c[0],u=c[1],l=function(){n.current.start=Date.now(),n.current.timer=setInterval((function(){var e=Math.floor((Date.now()-n.current.start)/1e3),t=Math.floor(e/3600),a=Math.floor(e%3600/60);u({h:t,m:a,s:e%60})}),1e3)},m=function(){clearInterval(n.current.timer),n.current.timer=0},h=function(){return o},f=function(){m(),u({h:0,m:0,s:0})},d=function(e){return String(e).padStart(2,"0")};return Object(r.useImperativeHandle)(t,(function(){return{start:l,end:m,getTime:h,reset:f}})),Object(r.useEffect)((function(){return m}),[]),s.a.createElement("p",{className:"timer"},s.a.createElement("span",null,d(o.h)),":",s.a.createElement("span",null,d(o.m)),":",s.a.createElement("span",null,d(o.s)))}))},46:function(e,t,n){"use strict";var a=n(12),r=n(0),s=n.n(r),i=n(37);n(47);t.a=Object(r.forwardRef)((function(e,t){var n=e.texts,c=void 0===n?[]:n,o=Object(r.useState)(!1),u=Object(a.a)(o,2),l=u[0],m=u[1],h=Object(r.useRef)(),f=function(){return m(!0),Object(i.a)(h.current,1e3*c.length)};return Object(r.useImperativeHandle)(t,(function(){return{play:f}})),s.a.createElement("ul",{className:"fadetext"},c.map((function(e,t){var n=t+1===c.length;return s.a.createElement("li",{ref:n?h:void 0,className:l?"show":"",key:t,style:{animationDelay:"".concat(t,"s")}},e)})))}))},47:function(e,t,n){},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(0),r=n.n(a),s=n(13),i=n(33),c=n.n(i),o=n(34);function u(){return(u=Object(o.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}if(!Reflect.has(t,"ontransitionend")){e.next=5;break}return e.abrupt("return",new Promise((function(e){t.addEventListener("transitionend",(function n(){t.removeEventListener("transitionend",n),e(!0)}))})));case 5:return e.abrupt("return",new Promise((function(e){setTimeout(e,n)})));case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(44);function l(e){var t=Object(a.useRef)(),n=t.current,i=function(){t.current&&t.current.remove()};return Object(a.useEffect)((function(){return i}),[]),e.visible?(n||((n=document.createElement("div")).className="modal",t.current=n),n.parentElement||document.body.appendChild(n),setTimeout((function(){return n.classList.add("fade")}))):n&&(n.classList.remove("fade"),function(e,t){return u.apply(this,arguments)}(n,500).then(i)),n?Object(s.createPortal)(r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"bg",onClick:e.onBgClick}),r.a.createElement("div",{className:"content"},e.children)),n):null}},54:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(33),i=n.n(s),c=n(56),o=n(34),u=n(31),l=n(35),m=1,h=2,f=3,d=4,p=5,b=6,v=7,g=8,w=function e(){var t=this;Object(u.a)(this,e),this.send=function(e,n){if(t.map.has(e)){var a,r=t.map.get(e),s=Object(l.a)(r);try{for(s.s();!(a=s.n()).done;){(0,a.value)(e,n)}}catch(i){s.e(i)}finally{s.f()}}},this.listen=function(e,n){var a;t.map.has(e)?(a=t.map.get(e)).push(n):a=[n],t.map.set(e,a)},this.mute=function(e,n){if(t.map.has(e)){var a=t.map.get(e);t.map.set(e,a.filter((function(e){return e!==n})))}},this.map=new Map},y=n(12),E=n(38),O=n(48),j=n(45),x=n(42);function P(e){var t=e.onConfirm;return r.a.createElement("div",{className:"modal_text"},r.a.createElement("p",{className:"start"},"\u5f00\u59cbCPR\u4e4b\u524d"),r.a.createElement("p",{className:"title"},"1.\u786e\u8ba4\u5f53\u524d\u73af\u5883\u5b89\u5168"),r.a.createElement("p",{className:"title"},"2.\u786e\u8ba4\u60a3\u8005\u5df2\u5fc3\u810f\u9aa4\u505c"),r.a.createElement("ul",{className:"desc"},r.a.createElement("li",null,"2.1 \u8f7b\u62cd\u4f24\u5458\u80a9\u8180,\u5927\u58f0\u547c\u558a\u60a3\u8005\uff0c\u65e0\u56de\u5e94"),r.a.createElement("li",null,"2.2 \u53e3\u9f3b\u65e0\u547c\u5438\uff0c\u80f8\u5ed3\u65e0\u8d77\u4f0f"),r.a.createElement("li",null,"2.3 \u9888\u52a8\u8109\u65e0\u640f\u52a8")),r.a.createElement("p",{className:"title"},"3.\u786e\u8ba4\u5df2\u4e3a\u60a3\u8005\u62a5\u8b66120"),r.a.createElement("button",{onClick:t},"\u786e\u8ba4"))}function I(e){var t=e.onConfirm;return r.a.createElement("div",{className:"modal_text"},r.a.createElement("p",{className:"start"},"\u62a2\u6551\u6210\u529f\uff01"),r.a.createElement("button",{onClick:t},"\u518d\u6765\u4e00\u6b21"))}function R(e){var t=e.onConfirm;return r.a.createElement("div",{className:"modal_text"},r.a.createElement("p",{className:"start"},"\u4eba\u5de5\u547c\u5438"),r.a.createElement("p",{className:"title"},"\u5f00\u653e\u6c14\u9053-\u538b\u989d\u62ac\u988f"),r.a.createElement("ul",{className:"desc"},r.a.createElement("li",null,"\u786e\u8ba4\u60a3\u8005\u65e0\u9888\u690e\u635f\u4f24\uff0c\u4e00\u624b\u653e\u5728\u524d\u989d\u5411\u4e0b\u538b\uff0c\u53e6\u4e00\u9996\u653e\u5728\u4e0b\u988c\u5411\u4e0a\u62ac\u8d77")),r.a.createElement("p",{className:"title"},"\u4eba\u5de5\u547c\u5438\u8981\u6c42"),r.a.createElement("ul",{className:"desc"},r.a.createElement("li",null,"\u53e3\u5bf9\u53e3\u8fde\u54392\u6b21\uff0c\u6bcf\u6b21\u81f3\u5c11\u6301\u7eed\u4e00\u79d2"),r.a.createElement("li",null,"\u5439\u6c14\u5e94\u80fd\u770b\u5230\u80f8\u5ed3\u6709\u8d77\u4f0f")),r.a.createElement("button",{onClick:t},"\u597d\u7684"))}function T(e){var t=e.onConfirm;return r.a.createElement("div",{className:"modal_text"},r.a.createElement("p",{className:"start"},"\u5982\u4f55\u8fdb\u884c\u80f8\u5916\u6309\u538b"),r.a.createElement("p",{className:"title"},"1.\u6309\u538b\u59ff\u52bf"),r.a.createElement("ul",{className:"desc"},r.a.createElement("li",null,"\u9760\u8fd1\u80f8\u90e8\u4e00\u4fa7\uff0c\u8131\u53bb\u60a3\u8005\u5916\u5957\uff0c\u4fdd\u8bc1\u6309\u538b\u529b\u91cf\u5782\u76f4\u4e8e\u80f8\u9aa8")),r.a.createElement("p",{className:"title"},"2.\u6309\u538b\u90e8\u4f4d"),r.a.createElement("ul",{className:"desc"},r.a.createElement("li",null,"\u6309\u538b\u90e8\u4f4d\u5728\u4e73\u5934\u8fde\u7ebf\u4e2d\u70b9\u5904")),r.a.createElement("p",{className:"title"},"3.\u6309\u538b\u624b\u52bf"),r.a.createElement("ul",{className:"desc"},r.a.createElement("li",null,"\u53cc\u638c\u53e0\u52a0\uff0c\u624b\u6307\u4e0d\u89e6\u78b0\u80f8\u90e8\uff0c\u80a9\u8180\u624b\u81c2\u5782\u76f4\u4e8e\u80f8\u9aa8")),r.a.createElement("p",{className:"title"},"4.\u6309\u538b\u9891\u7387\u5e45\u5ea6"),r.a.createElement("ul",{className:"desc"},r.a.createElement("li",null,"\u9891\u7387\u6bcf\u5206\u949f100\u6b21\u4ee5\u4e0a\uff0c\u5e45\u5ea6\u4e3a\u6210\u4eba5cm\u3001\u5e7c\u513f3cm\u3001\u5a74\u513f2cm\u5de6\u53f3")),r.a.createElement("button",{onClick:t},"\u5f00\u59cb"))}function N(){var e=Object(a.useState)(!1),t=Object(y.a)(e,2),n=t[0],r=t[1],s=Object(a.useRef)();return{visibility:n,show:function(){return new Promise((function(e){r(!0),s.current=e}))},hide:function(){r(!1),s.current&&s.current()}}}var C=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)(!1),s=Object(y.a)(n,2),i=s[0],c=s[1],o=Object(a.useState)(""),u=Object(y.a)(o,2),l=u[0],m=u[1],h=N(),f=h.visibility,d=h.show,p=h.hide,b=N(),v=b.visibility,g=b.show,w=b.hide,C=N(),k=C.visibility,S=C.show,M=C.hide,H=N(),B=H.visibility,A=H.show,L=H.hide,U=Object(a.useRef)(),F=Object(a.useRef)(),D=Object(a.useRef)(),G=function(){U.current&&U.current.beat()},z=function(e){U.current&&U.current.setMode(e)},_=function(){F.current.start()},W=function(){D.current.show()},X=function(){D.current.hide()},q=function(){D.current.togglePlay()};return Object(a.useEffect)((function(){e.onMount()})),Object(a.useImperativeHandle)(t,(function(){return{setHeartBeatVisibility:c,playHeartBeat:G,setHeartBeatMode:z,showConfirm:d,startTimer:_,showPushIntro:g,toggleTap:q,showAirwayIntro:S,showSuccess:A,showTap:W,hideTap:X,setBtnText:m}})),r.a.createElement("div",{className:"status"},r.a.createElement(E.b,{visibility:i,ref:U}),r.a.createElement(O.a,{visible:f},r.a.createElement(P,{onConfirm:p})),r.a.createElement(O.a,{visible:v},r.a.createElement(T,{onConfirm:w})),r.a.createElement(O.a,{visible:k},r.a.createElement(R,{onConfirm:M})),r.a.createElement(O.a,{visible:B},r.a.createElement(I,{onConfirm:function(){L()}})),r.a.createElement("div",{className:"time_past"},r.a.createElement("p",{className:"text"},"\u5df2\u7528\u65f6\u95f4"),r.a.createElement(j.a,{ref:F})),r.a.createElement(x.a,{ref:D,onTap:e.onTap,speed:120,requirement:.2}),l?r.a.createElement("button",{className:"operate_btn",onClick:e.onBtnPress},l):null)})),k=n(46),S=n(37),M=["\u8fd1\u5e74\u6765\u731d\u6b7b\u53d1\u751f\u9891\u7387\u9010\u6e10\u63d0\u9ad8\uff0c\u4e14\u6709\u5e74\u8f7b\u5316\u8d8b\u52bf","\u5fc3\u535a\u9aa4\u505c\u4e0d\u53ca\u65f6\u62a2\u6551\u53ef\u7acb\u523b\u5931\u53bb\u751f\u547d","\u5982\u679c\u57284\u5206\u949f\u5185\u5b9e\u65bd\u521d\u6b65\u7684CPR(\u5fc3\u80ba\u590d\u82cf\u672f)","\u62a2\u6551\u6210\u529f\u7684\u53ef\u80fd\u6027\u4f1a\u5927\u5927\u63d0\u9ad8\uff01","\u901a\u8fc7\u672c\u7a0b\u5e8f\u6765\u5b66\u4e60CPR\u77e5\u8bc6","\u53c2\u4e0e\u4e00\u6b21\u6a21\u62df\u62ef\u6551\u5427\u3002"],H=Object(a.forwardRef)((function(e,t){var n=e.onMount,s=e.onStart,i=Object(a.useRef)(),c=Object(a.useRef)(),o=Object(a.useState)(!1),u=Object(y.a)(o,2),l=u[0],m=u[1],h=Object(a.useState)(!1),f=Object(y.a)(h,2),d=f[0],p=f[1],b=Object(a.useState)(0),v=Object(y.a)(b,2),g=v[0],w=v[1],E=function(){return m(!0),Object(S.a)(c.current,2e3)},O=function(){return i.current.play()},j=function(){p(!0)};Object(a.useImperativeHandle)(t,(function(){return{playText:O,zoomOut:E,setProgress:w,showStartButton:j}})),Object(a.useEffect)((function(){n()}));var x=100===g?"\u5f00\u59cb":"\u52a0\u8f7d\u4e2d ".concat(Math.floor(g),"%"),P=g>=100?s:null;return r.a.createElement("div",{ref:c,className:"intro fullscreen ".concat(l?"zoom":"")},r.a.createElement("img",{src:"/images/Intro/heart.jpg",className:"bg",alt:"bg"}),r.a.createElement(k.a,{ref:i,texts:M}),r.a.createElement("div",{className:"start ".concat(d?"show":""),onClick:P},x))})),B=n(13),A=n.n(B),L=function e(t,n){var s=this;Object(u.a)(this,e),this.showIntro=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A.a.unmountComponentAtNode(s.container),t=function(){s.messenger.send(m)},e.next=4,new Promise((function(e){A.a.render(r.a.createElement(H,{ref:s.introRef,onMount:e,onStart:t}),s.container)}));case 4:return e.next=6,s.introRef.current.playText();case 6:s.introRef.current.showStartButton();case 7:case"end":return e.stop()}}),e)}))),this.zoomOutIntro=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.introRef.current.zoomOut();case 2:A.a.unmountComponentAtNode(s.container);case 3:case"end":return e.stop()}}),e)}))),this.updateIntroProgress=function(e,t){s.introRef.current&&s.introRef.current.setProgress(100*t.progress)},this.showStatusUI=function(){return new Promise((function(e){A.a.render(r.a.createElement(C,{ref:s.statusRef,onMount:e,onTap:s.onTap,onBtnPress:s.onBtnPress}),s.container)}))},this.playHeartBeat=function(){s.statusRef.current.setHeartBeatVisibility(!0),s.statusRef.current.playHeartBeat()},this.playHeartAttack=function(){s.statusRef.current.setHeartBeatMode(E.a.RIP)},this.confirmHeartAttack=function(){return s.statusRef.current.showConfirm()},this.showPushIntro=function(){return s.statusRef.current.showPushIntro()},this.startTap=function(){return new Promise((function(e){s.statusRef.current.showTap(),s.statusRef.current.toggleTap(),s.tapProcess=e}))},this.stopTap=function(){s.statusRef.current.hideTap(),s.statusRef.current.toggleTap(),s.tapProcess&&(s.tapProcess(),s.tapProcess=null)},this.onTap=function(){s.pushTimes++,s.pushTimes>=30&&(s.pushTimes=0,s.stopTap()),s.messenger.send(g)},this.startTimer=function(){s.statusRef.current.startTimer()},this.waitBtn=function(e){return new Promise((function(t){s.statusRef.current.setBtnText(e),s.btnProcess=t}))},this.onBtnPress=function(){s.statusRef.current.setBtnText(""),s.btnProcess&&s.btnProcess(),s.btnProcess=null},this.showAirwayIntro=function(){return s.statusRef.current.showAirwayIntro()},this.showSuccess=function(){return s.statusRef.current.showSuccess()},this.container=t,this.messenger=n,this.pushTimes=0,this.introRef=Object(a.createRef)(),this.statusRef=Object(a.createRef)(),this.messenger.listen(f,this.updateIntroProgress)},U=function e(t){var n=this;Object(u.a)(this,e),this.receiveModel=function(e,t){console.log(t),n.geometry=t},this.getGeometry=function(){return n.geometry.scene?n.geometry.scene:n.geometry},this.ready=function(){n.getGeometry().traverse((function(e){e.isMesh&&(e.castShadow=!0,e.material.skinning=!0)}))},this.standby=function(){var e=n.getGeometry();e.scale.set(20,20,20),e.rotation.set(0,0,-.5*Math.PI),e.position.set(50,0,0)},this.takeoff=function(){n.getGeometry().traverse((function(e){"g_Clothes_low_uv1Group29821"===e.name&&(e.visible=!1)}))},this.anmFaint=function(){},this.getScreenCoords=function(){return n.util.getScreenCoords(n.getGeometry())},this.render=function(e,t){n.mixer&&n.mixer.update(300*t.frameTime)},this.messenger=t,t.listen(h,this.render),t.listen(p,this.receiveModel)},F=n(32),D=function e(t,n){var a=this;Object(u.a)(this,e),this.standby=function(){a.geometry.push.position.set(20,-5,20),a.geometry.push.rotation.set(.5*Math.PI,.5*Math.PI,0),a.geometry.lift.position.set(27,1,13),a.geometry.lift.rotation.set(-.5*Math.PI,0,-.8*Math.PI),a.geometry.press.position.set(42,3,12),a.geometry.press.rotation.set(.5*Math.PI,.5*Math.PI,0);var e,t=Object(l.a)(a.getGeometry());try{for(t.s();!(e=t.n()).done;){e.value.traverse((function(e){e.isMesh&&(e.material=new F.R({color:15839877,skinning:!0}))}))}}catch(n){t.e(n)}finally{t.f()}a.geometry.push.visible=!1,a.geometry.lift.visible=!1,a.geometry.press.visible=!1},this.push=function(){a.isAnmPushing||(a.isAnmPushing=Date.now())},this.showPushHand=function(){a.geometry.push.visible=!0},this.hidePushHand=function(){a.geometry.push.visible=!1},this.showLiftHand=function(){a.geometry.lift.visible=!0},this.hideLiftHand=function(){a.geometry.lift.visible=!1},this.showPressHand=function(){a.geometry.press.visible=!0},this.hidePressHand=function(){a.geometry.press.visible=!1},this.getGeometry=function(){return Object.values(a.geometry)},this.receivePushModel=function(e,t){a.geometry[t.name]=t.mesh},this.render=function(){if(a.isAnmPushing){var e=Date.now()-a.isAnmPushing;if(e>300)a.geometry.push.position.z=20,a.isAnmPushing=null;else{var t=1-2*Math.abs(.5-e/300);a.geometry.push.position.z=20-10*t}}},this.messenger=t,this.util=n,this.geometry={},t.listen(h,this.render),t.listen(v,this.receivePushModel),t.listen(g,this.push)},G=function e(t){var n=this;Object(u.a)(this,e),this.ready=function(){var e=new F.pb;e.background=new F.k(16777215),n.scene=e},this.getScene=function(){return n.scene},this.receiveSkyTexture=function(e,t){n.skyTexture=t},this.createBackground=function(){var e=new F.gb(1e3,1e3),t=new F.T({map:n.skyTexture,color:16777215}),a=new F.Q(e,t);a.rotateX(.5*Math.PI),a.position.set(0,500,500),n.scene.add(a)},this.createFloor=function(){var e=new F.gb(1e3,1e3),t=new F.U({color:16777215,depthWrite:!1}),a=new F.Q(e,t);a.position.set(0,0,0),a.receiveShadow=!0,n.scene.add(a)},this.buildScene=function(e){console.log(e),n.createFloor(),n.createBackground();var t,a=Object(l.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.scene.add(r)}}catch(s){a.e(s)}finally{a.f()}},this.messenger=t,t.listen(b,this.receiveSkyTexture)},z=function e(t,n){var a=this;Object(u.a)(this,e),this.ready=function(){var e=new F.Hb({canvas:a.canvas});e.setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),e.toneMapping=F.a,e.toneMappingExposure=1.25,e.outputEncoding=F.Ib,e.shadowMap.enabled=!0,e.shadowMap.type=F.eb,a.renderer=e},this.play=function(e){var t=e.scene,n=e.camera;a.scene=t,a.camera=n,a.render()},this.render=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!a.startTime&&e&&(a.startTime=e);var t=a.scene,n=a.camera;a.messenger.send(h,{pastTime:e-a.startTime,frameTime:a.lastFrameTime?e-a.lastFrameTime:0}),a.renderer.render(t,n),a.lastFrameTime=e,requestAnimationFrame(a.render)},this.canvas=t,this.messenger=n,this.startTime=0,this.lastFrameTime=0},_=n(41),W=function e(t,n){var a=this;Object(u.a)(this,e),this.ready=function(){a.messenger.listen(h,a.render);var e=new F.fb(90,window.innerWidth/window.innerHeight,1,1e4);a.camera=e},this.standby=function(){a.focusBody()},this.enableUserControl=function(){var e=new _.a(a.camera,a.canvas);e.enablePan=!1,e.enableZoom=!1,a.control=e},this.getCamera=function(){return a.camera},this.focusBody=function(){a.camera.position.set(0,-80,50),a.control&&(a.control.target=new F.Eb(0,0,0),a.control.update())},this.focusChest=function(){a.camera.position.set(15,-60,45),a.control&&(a.control.target=new F.Eb(15,0,0),a.control.update())},this.focusHead=function(){a.camera.position.set(30,-40,25),a.control&&(a.control.target=new F.Eb(30,0,0),a.control.update())},this.render=function(e,t){},this.canvas=t,this.messenger=n},X=function e(){var t=this;Object(u.a)(this,e),this.lights={},this.ready=function(){var e=new F.b(16777215,3),n=new F.m(16777215,1);n.position.multiplyScalar(1.3),n.castShadow=!0;var a=300;n.shadow.mapSize.width=1024,n.shadow.mapSize.height=1024,n.shadow.camera.left=-a,n.shadow.camera.right=a,n.shadow.camera.top=a,n.shadow.camera.bottom=-a,n.shadow.camera.far=1e3,t.lights={amLight:e,dirLight:n}},this.standby=function(){t.lights.dirLight.position.set(0,-300,100)},this.getLights=function(){return Object.values(t.lights)}},q=n(49),V=n(55),J=n(53),Q="assets/patient/patient.glb",$="assets/skybox2/clouds1_north.bmp",K="assets/hands/HandPush/HandPush.fbx",Z="assets/hands/HandLift/Lift.fbx",Y="assets/hands/HandPress/Press.fbx",ee=function e(t){var n=this;Object(u.a)(this,e),this.onComplete=function(){},this.onProgress=function(e,t,a){console.log("loaded",e,t,a),n.messenger.send(f,{progress:t/a})},this.onError=function(){n.messenger.send(d)},this.loadGLTF=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new q.a(n.manager);return a&&((t=new J.a(n.manager)).setDecoderPath("libs/draco/"),t.setDecoderConfig({type:"js"}),t.preload(),r.setDRACOLoader(t)),new Promise((function(t){r.load(e,t)}))},this.loadTexture=function(e){return new F.zb(n.manager).load(e)},this.loadFBX=function(e){var t=new V.a(n.manager);return new Promise((function(n){t.load(e,n)}))},this.loadResources=Object(o.a)(i.a.mark((function e(){var t,a,r,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.loadTexture($),n.messenger.send(b,t),e.next=4,n.loadGLTF(Q,!1);case 4:return a=e.sent,n.messenger.send(p,a),e.next=8,n.loadFBX(K);case 8:return r=e.sent,n.messenger.send(v,{name:"push",mesh:r}),e.next=12,n.loadFBX(Z);case 12:return s=e.sent,n.messenger.send(v,{name:"lift",mesh:s}),e.next=16,n.loadFBX(Y);case 16:c=e.sent,n.messenger.send(v,{name:"press",mesh:c});case 18:case"end":return e.stop()}}),e)}))),this.manager=new F.K(this.onComplete,this.onProgress,this.onError),this.messenger=t};var te=function e(){var t=this;Object(u.a)(this,e),this.ready=function(e){t.camera=e.camera},this.getScreenCoords=function(e){return function(e,t){var n=e.position.clone().project(t),a=window.screen,r=a.availWidth,s=a.availHeight;return{x:(n.x+1)*r/2,y:(1-n.y)*s/2}}(e,t.camera)}},ne=function e(t,n){var a=this;Object(u.a)(this,e),this.ready=function(){a.scenery.ready(),a.screen.ready(),a.photographer.ready(),a.light.ready(),a.util.ready({camera:a.photographer.getCamera()}),a.messenger.listen(m,a.onMessage)},this.action=Object(o.a)(i.a.mark((function e(){var t,n,r,s,o,u,l,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.loader,n=a.patient,r=a.light,s=a.scenery,o=a.photographer,u=a.UI,l=a.screen,m=a.angel,u.showIntro(),e.next=4,t.loadResources();case 4:a.cpr(),s.buildScene([n.getGeometry()].concat(Object(c.a)(r.getLights()),Object(c.a)(m.getGeometry()))),n.ready(),n.standby(),m.standby(),r.standby(),o.standby(),o.enableUserControl(),l.play({scene:s.getScene(),camera:o.getCamera()});case 13:case"end":return e.stop()}}),e)}))),this.cpr=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.UI.zoomOutIntro();case 2:return e.next=4,a.UI.showStatusUI();case 4:return a.UI.playHeartBeat(),e.next=7,a.UI.confirmHeartAttack();case 7:return e.next=9,a.patient.anmFaint();case 9:return e.next=11,a.UI.showPushIntro();case 11:return a.UI.playHeartAttack(),a.UI.startTimer(),e.next=15,a.UI.waitBtn("\u8131\u53bb\u8863\u7269");case 15:return a.patient.takeoff(),a.photographer.focusChest(),a.angel.showPushHand(),e.next=20,a.UI.startTap();case 20:return a.angel.hidePushHand(),a.photographer.focusHead(),a.angel.showLiftHand(),a.angel.showPressHand(),e.next=26,a.UI.showAirwayIntro();case 26:return e.next=28,a.UI.waitBtn("\u5439\u6c14 1/2");case 28:return e.next=30,a.UI.waitBtn("\u5439\u6c14 2/2");case 30:return a.UI.playHeartBeat(),e.next=33,a.UI.showSuccess();case 33:case"end":return e.stop()}}),e)}))),this.onMessage=function(e,t){switch(e){case m:a.messenger.mute(m,a.onMessage),a.cpr()}};var r=new w,s=new te;this.UI=new L(t,r),this.scenery=new G(r),this.screen=new z(n,r),this.photographer=new W(n,r),this.patient=new U(r),this.angel=new D(r),this.light=new X,this.loader=new ee(r),this.messenger=r,this.util=s};n(54),t.default=function(){var e=Object(a.useRef)(),t=Object(a.useRef)();return Object(a.useEffect)((function(){var n=new ne(e.current,t.current);n.ready(),n.action()})),r.a.createElement("div",{className:"cpr"},r.a.createElement("div",{className:"ui",ref:e}),r.a.createElement("canvas",{className:"canvas",ref:t}))}}}]);
//# sourceMappingURL=6.42c1ef7f.chunk.js.map